<div class="container">
	<h3>Friends!</h3>

	{% if friends.error %}
	<div class="alert alert-danger" role="alert">Error: {{friends.error}}</div>
	{% endif %}

	{% if success %}
	<div class="alert alert-success" role="alert">{{friends.success}}</div>
	{% endif %}

	{% if self_profile %}
	<form id="addFriendForm" >
		{% csrf_token %}
		{% for field in friends.form %}
		<div class="form-floating">
			{{ field }}
			{{ field.label_tag }}
			<p style="color: red">{{ field.errors }}<p>
		</div>
		{% endfor %}
		<button type="submit" id="addFriendButton" class="btn btn-primary">Add friend</button>
		<button type="submit" id="blockUserButton" class="btn btn-danger">Block user</button>
	</form>
	
	</br>

	<div>
		<h4>Pending Invites</h4>
		<ul class="list-group list-group-flush">
			{% for invite in friends.in_invites %}
				<li class="list-group-item h5">
					<a class="pe-5" id="profileLinkTag" href="/profile/{{ invite.from_user.username }}" >{{ invite.from_user.username }}</a>
					<button type="submit" id="friendRequestButton" data-from-user={{ invite.from_user.username }} data-action="accept" class="btn btn-primary">Accept</button> or
					<button type="submit" id="friendRequestButton" data-from-user={{ invite.from_user.username }} data-action="reject" class="btn btn-danger">Reject</button>
				</li>
			{% empty %}
				<li class="list-group-item">No pending invites.</li>
			{% endfor %}
		</ul>

		<br>
		<h4>Blocked Users</h4>
		<ul class="list-group list-group-flush">
			{% for blocked in friends.blocked_users %}
				<li class="list-group-item h5">
					{{ blocked.username }} 
					<button type="submit" id="friendRequestButton" data-from-user={{ blocked.username }} data-action="unblock" class="btn btn-outline-danger ms-5">Unblock</button>
				</li>
			{% empty %}
				<li class="list-group-item">No blocked users.</li>
			{% endfor %}
		</ul>
		<br>
		{% endif %}

		<h4>List of friends</h4>
		{% if self_profile %}
		<ul class="list-group list-group-flush">
			{% for invite in friends.out_invites %}
				<li class="list-group-item pe-5 text-secondary">
					<a class="h5 text-black" id="profileLinkTag" href="/profile/{{ invite.to_user.username }}" >{{ invite.to_user.username }}</a> 
					Friend request pending...
				</li>
			{% endfor %}

			{% for friendship in friends.friendships %}
				{% if friends.current_user == friendship.to_user %}
					<li class="list-group-item h5 pe-5">
						<a id="profileLinkTag" href="/profile/{{ friendship.from_user.username }}" >{{ friendship.from_user.username }}</a> 
						{% if friendship.from_user.is_online %}
						<span class="text-success" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-laughing-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5c0 .501-.164.396-.415.235C6.42 6.629 6.218 6.5 6 6.5s-.42.13-.585.235C5.164 6.896 5 7 5 6.5 5 5.672 5.448 5 6 5s1 .672 1 1.5m5.331 3a1 1 0 0 1 0 1A5 5 0 0 1 8 13a5 5 0 0 1-4.33-2.5A1 1 0 0 1 4.535 9h6.93a1 1 0 0 1 .866.5m-1.746-2.765C10.42 6.629 10.218 6.5 10 6.5s-.42.13-.585.235C9.164 6.896 9 7 9 6.5c0-.828.448-1.5 1-1.5s1 .672 1 1.5c0 .501-.164.396-.415.235"/>
							</svg>
						</span>
						{% else %}
						<span class="text-secondary" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-frown-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m-2.715 5.933a.5.5 0 0 1-.183-.683A4.5 4.5 0 0 1 8 9.5a4.5 4.5 0 0 1 3.898 2.25.5.5 0 0 1-.866.5A3.5 3.5 0 0 0 8 10.5a3.5 3.5 0 0 0-3.032 1.75.5.5 0 0 1-.683.183M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
							</svg>
						</span>
						{% endif %}
						<button type="submit" id="friendRequestButton" data-from-user={{ friendship.from_user.username }} data-action="delete" class="btn btn-outline-danger ms-5">Unfriend</button>
					</li>
				{% else %}
					<li class="list-group-item h5 pe-5">
						<a id="profileLinkTag" href="/profile/{{friendship.to_user.username}}" >{{ friendship.to_user.username }}</a> 
						{% if friendship.to_user.is_online %}
						<span class="text-success" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-laughing-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5c0 .501-.164.396-.415.235C6.42 6.629 6.218 6.5 6 6.5s-.42.13-.585.235C5.164 6.896 5 7 5 6.5 5 5.672 5.448 5 6 5s1 .672 1 1.5m5.331 3a1 1 0 0 1 0 1A5 5 0 0 1 8 13a5 5 0 0 1-4.33-2.5A1 1 0 0 1 4.535 9h6.93a1 1 0 0 1 .866.5m-1.746-2.765C10.42 6.629 10.218 6.5 10 6.5s-.42.13-.585.235C9.164 6.896 9 7 9 6.5c0-.828.448-1.5 1-1.5s1 .672 1 1.5c0 .501-.164.396-.415.235"/>
							</svg>
						</span>
						{% else %}
						<span class="text-secondary" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-frown-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m-2.715 5.933a.5.5 0 0 1-.183-.683A4.5 4.5 0 0 1 8 9.5a4.5 4.5 0 0 1 3.898 2.25.5.5 0 0 1-.866.5A3.5 3.5 0 0 0 8 10.5a3.5 3.5 0 0 0-3.032 1.75.5.5 0 0 1-.683.183M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
							</svg>
						</span>
						{% endif %} 
						<button type="submit" id="friendRequestButton" data-from-user={{ friendship.to_user.username }} data-action="delete" class="btn btn-outline-danger ms-5">Unfriend</button>
					</li>
				{% endif %}
			{% empty %}
				<li class="list-group-item">No friends :0</li>
			{% endfor %}
		</ul>
		{% else %}
		{% comment %} for other's profiles {% endcomment %}
		<ul class="list-group list-group-flush">
			{% for friendship in friends.friendships %}
				{% if friends.current_user == friendship.to_user %}
					<li class="list-group-item h5 pe-5">
						<a id="profileLinkTag" href="/profile/{{friendship.from_user.username}}" >{{ friendship.from_user.username }}</a>
						{% if friendship.from_user.is_online %}
						<span class="text-success" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-laughing-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5c0 .501-.164.396-.415.235C6.42 6.629 6.218 6.5 6 6.5s-.42.13-.585.235C5.164 6.896 5 7 5 6.5 5 5.672 5.448 5 6 5s1 .672 1 1.5m5.331 3a1 1 0 0 1 0 1A5 5 0 0 1 8 13a5 5 0 0 1-4.33-2.5A1 1 0 0 1 4.535 9h6.93a1 1 0 0 1 .866.5m-1.746-2.765C10.42 6.629 10.218 6.5 10 6.5s-.42.13-.585.235C9.164 6.896 9 7 9 6.5c0-.828.448-1.5 1-1.5s1 .672 1 1.5c0 .501-.164.396-.415.235"/>
							</svg>
						</span>
						{% else %}
						<span class="text-secondary" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-frown-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m-2.715 5.933a.5.5 0 0 1-.183-.683A4.5 4.5 0 0 1 8 9.5a4.5 4.5 0 0 1 3.898 2.25.5.5 0 0 1-.866.5A3.5 3.5 0 0 0 8 10.5a3.5 3.5 0 0 0-3.032 1.75.5.5 0 0 1-.683.183M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
							</svg>
						</span>
						{% endif %}
					</li>
				{% else %}
					<li class="list-group-item h5 pe-5">
						<a id="profileLinkTag" href="/profile/{{friendship.to_user.username}}" >{{ friendship.to_user.username }}</a> 
						{% if friendship.to_user.is_online %}
						<span class="text-success" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-laughing-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5c0 .501-.164.396-.415.235C6.42 6.629 6.218 6.5 6 6.5s-.42.13-.585.235C5.164 6.896 5 7 5 6.5 5 5.672 5.448 5 6 5s1 .672 1 1.5m5.331 3a1 1 0 0 1 0 1A5 5 0 0 1 8 13a5 5 0 0 1-4.33-2.5A1 1 0 0 1 4.535 9h6.93a1 1 0 0 1 .866.5m-1.746-2.765C10.42 6.629 10.218 6.5 10 6.5s-.42.13-.585.235C9.164 6.896 9 7 9 6.5c0-.828.448-1.5 1-1.5s1 .672 1 1.5c0 .501-.164.396-.415.235"/>
							</svg>
						</span>
						{% else %}
						<span class="text-secondary" id="online_status">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-emoji-frown-fill" viewBox="0 0 16 16">
								<path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m-2.715 5.933a.5.5 0 0 1-.183-.683A4.5 4.5 0 0 1 8 9.5a4.5 4.5 0 0 1 3.898 2.25.5.5 0 0 1-.866.5A3.5 3.5 0 0 0 8 10.5a3.5 3.5 0 0 0-3.032 1.75.5.5 0 0 1-.683.183M10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8"/>
							</svg>
						</span>
						{% endif %} 
					</li>
				{% endif %}
			{% empty %}
				<li class="list-group-item">No friends :0</li>
			{% endfor %}
		</ul>
		{% endif %}
	</div>
</div>
